 -*- mode: text; mode: auto-fill; -*-

MML2MIDfe v2
============

MML2MID コンパイラを使用した MML による作曲は，MML に慣れさえすればシー
ケンサ以上のスピードで打ち込みができるようになりますが，GUI が主流の昨
今において，コマンドラインベースでのコンパイラの操作は（エディタのマク
ロなどの支援ツールなしには）扱いにくいものと思われます。

また，MML2MID の Windows GUI 版は，事故によるソース紛失のために長い間バー
ジョンアップが行われておらず，Windows GUI 環境において，最新の MML2MID
を使うことは出来なくなっています。

MML2MID を GUI で実現するということについては，先発として新出さんによる
tkmml2mid がありますが， 前設定をしなければならないこと，Windows 環境で
は Tcl/Tk を導入しなければならないこと， Win32 の機能を十分に発揮するこ
とは出来ないことなどから，この MML2MIDfe を制作しました。

……以上 v1 系のヘルプからコピペ（ぉ

よく変な挙動をする mml2mid.dll をベースに Delphi で書かれていたかつての
MML2MIDfe を，コマンドライン版 mml2mid.exe と C++ で書き直してみました．

1. mml2mid.dll を使用せず，コマンドライン版の mml2mid.exe を直接使うよ
うにした
  mml2mid.dll で時々起きるクラッシュを回避し，常に最新の mml2mid.exe
  を使用できます．
2. Delphi でなく，C++ / WTL で書き直した
  生成バイナリが小さく，速くなりました．
3. ヘルプがしょぼくなった
  ごらんのとおりテキストファイルです（ぉ

MML2MIDfe v1 系から削られた機能は以下の二点ですが，とりあえず私がまだい
らないと考えているだけで，これなくなったら困るんだけど等のご意見をいた
だければ考え直します．

1. コマンドラインオプションが使えなくなった
2. 自動コンパイル・自動再生が使えない

MML2MID v1 系になるべく似せて作ってありますので，v1 系をお使いだった方
は移行しやすいと思います．初めての方にも極力説明不要になるよう作ったつ
もりです．


インストール
------------
MML2MIDfe.exe と同じディレクトリに mml2mid.exe を置いてください．
[オプション] メニュー - [設定] - [MML2MID のパス] で，異なる場所にある
mml2mid.exe を指定することができます．

アンインストールするにはファイル一式を削除するだけです．設定はレジスト
リの HKEY_CURRENT_USER\Software\Autch\MML2MIDfe\Preferences に書かれて
います．


コンパイルまでの流れ
--------------------

お好みのエディタで mml ファイルを作成します．mml ファイルの書き方や文法
については mml2mid のマニュアルをご覧ください．

MML2MIDfe を起動し，「MML ファイル名」のところに先ほど作成した mml ファ
イルを指定します．すると，「SMF ファイル名」のところに自動的にコンパイ
ル後の SMF ファイル名が入ります．

あとは「コンパイル」ボタンを押すだけです．エラーがなければ SMF ファイル
が生成されます．

基本的にメインウィンドウの各種オプションは見てのとおりです．「自動再生」
と「自動コンパイル」はまだ使えません．常時灰色になっています．


設定
----
メインウィンドウの [オプション] メニューから [設定] を選ぶと，MML ファ
イルの編集に使うエディタや SMF ファイルの再生に使うプレーヤを設定し，
これらと連携することができるようになります．

エディタとプレーヤの設定はデフォルトのままでも関連付けさえされていれば
そのまま使えますが，行番号ジャンプのできるエディタを使ったり，プレーヤ
のコマンドラインオプションを使ったりするにはここでの設定が必要になりま
す．基本的に各項目は見たまんまですので，設定例を挙げておきます．

[MML2MID のパス] の項目は，MML2MIDfe.exe のあるディレクトリをカレント
としています．mml2mid.exe が PATH の通ったディレクトリにあったり，
MML2MIDfe.exe と同じディレクトリにあったりするときはここは mml2mid.exe
だけで OK です．

MML エディタの設定で「指定したアプリケーションで開く」を選んだときは，
たとえば秀丸エディタの場合は次のように設定します．

通常時："C:\Program Files\Hidemaru\Hidemaru.exe" "%f"
行番号付："C:\Program Files\Hidemaru\Hidemaru.exe" /j%l "%f"

QX エディタの場合は次のようにします．

通常時："C:\Program Files\QX\QXW32.EXE" "%f"
行番号付："C:\Program Files\QX\QXW32.EXE" "%f",%l

Meadow の場合は次のようにします（vim も同様です）．

通常時：C:\usr\local\meadow\bin\RunMW32.exe "%f"
行番号付：C:\usr\local\meadow\bin\RunMW32.exe +%l "%f"

xyzzy の場合は次のようにします

通常時：C:\usr\local\xyzzy\xyzzycli.exe "%f"
行番号付：C:\usr\local\xyzzy\xyzzycli.exe "%f" -g %l

%f がファイル名に置き換えられますので適宜クォートしてください．

%l は行番号に置き換えられます．コンパイルエラーメッセージに行番号が含ま
れる場合，そのメッセージをダブルクリックすることでエディタの該当行にジャ
ンプできます．


SMF プレーヤのほうも同様に %f が *.mid ファイル名になります．KbMedia
Player なら，

"C:\Program Files\KbMedia Player\Kbmplay.exe" /mx:"%f" "%f" /play

このようにすると MML2MIDfe の「再生」ボタンを押すたびにファイルを開き
なおして再生するようになります．/mx:"%f" オプションはお好みに応じてつ
けて下さい．


リンク
------

MML2MID: http://platz.jp/~mml2mid/
Autch.net: http://www.autch.net/


ライセンス
----------

MML2MIDfe は MIT ライセンスで配布されます。ライセンスの条文は LICENSE
ファイルをご覧ください。


履歴
----
Version 2.0.0.1 2006.12.11 03:15
・v2 系初版．

2010.12.16
・独自のものに変わって MIT ライセンスを適用。

---------------------
Autch
http://www.autch.net/
autch@autch.net
